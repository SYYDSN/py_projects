{% extends "admin_template.html" %}
{% block extend_js %}
    <script src="../static/js/admin_requests.js"></script>
{% endblock %}
{% block extend_css %}
    <link rel="stylesheet" href="../static/css/admin_requests.css">
{% endblock %}
{% block main %}
    <div class="col-lg-12 col-md-12">
        <div class="row">
            <div class="small_nav col-lg-7 col-md-7">
                <div id="request_count">共计 {{ request_count }} 个作业</div>
            </div>
            <div class="search_bar col-lg-5 col-md-5">
                <div class="input-group input-group-sm">
                    <input id="key_word" type="text" class="form-control" placeholder="">
                    <div class="input-group-btn">
                        <button id="current_class" data-name="customer_alias" type="button"
                                class="btn btn-default dropdown-toggle" data-toggle="dropdown"
                                aria-haspopup="true" aria-expanded="false">所属用户<span class="caret"></span></button>
                        <ul id="select_class" class="dropdown-menu dropdown-menu-right">
                            <li><a data-name="customer_alias" href="#">所属用户</a></li>
                            <li><a data-name="end_date" href="#">作业日期</a></li>
                        </ul>
                        <button id="launch_search" class="btn btn-primary btn-group-xs">Go</button>
                    </div><!-- /btn-group -->
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12 col-md-12">
            <table id="request_table" class="table table-hover">
                <tr>
                    <th>作业序号</th>
                    <th>请求日期</th>
                    <th>所属用户</th>
                    <th>本次上传批次数</th>
                    <th>已完成完批次数</th>
                    <th>完成度</th>
                    <!--<th>备注</th>-->
                    <th>操作</th>
                </tr>
                {% for request in request_data %}
                    <tr id="{{ request.request_sn }}">
                        <td class="request_sn">{{ request.request_sn }}</td>
                        <td class="customer_sn" style="display:none">{{ request.customer_sn }}</td>
                        <td class="begin_date" style="display:none">{{ request.begin_date }}</td>
                        <td class="end_date">{{ request.end_date }}</td>
                        <td class="company_alias">{{ sn_alias[request.customer_sn] }}</td>
                        <td class="batch_count">{{ request.batch_count }}</td>
                        <td class="finish_count">{{ request.finish_count }}</td>
                        <td class="my_per">{{ (((request.finish_count / request.batch_count) * 1000) | int ) /10 if request.batch_count != 0 else 0 }}%</td>
                        <td class="description" style="display:none">{{ request.description }}</td>
                        <td class="not"><a href="/manage_batches?term=request_sn&key_word={{ request.request_sn }}"><button class="btn btn-xs btn-primary">查看详情</button></a></td>
                    </tr>
                {% endfor %}
            </table>
        </div>
    </div>
    <!-- 底部分页 -->
    <div class="row text-center">
        <nav aria-label>
            <ul id="page_list" class="pagination">
                <li class="{{ 'disabled' if index_range[0] == 1 else '' }}"><a
                        href="/manage_requests?index={{ prev_index }}" aria-label="Previous"><span
                        aria-hidden="true">&laquo;</span></a></li>
                {% for index in index_range %}
                    <li class="{{ 'active' if index == current_index else '' }}">
                        <a href="/manage_requests?index={{ index }}">{{ index }}</a>
                    </li>
                {% endfor %}
                <li class="{{ 'disabled' if index_range[-1] == max_index else '' }}"><a
                        href="/manage_requests?index={{ next_index }}" aria-label="Next"><span
                        aria-hidden="true">»</span></a></li>
            </ul>
        </nav>
    </div>
    </div>
    <!--模态框-->
    <button id="pop_modal" style="display: none" type="button" class="btn btn-primary btn-lg" data-toggle="modal"
            data-target="#myModal">
        Launch demo modal
    </button>

    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" style="text-align: center" id="myModalLabel">编辑发票信息</h4>
                </div>
                <div class="modal-body">

                    <div class="form-inline row">
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="ticket_id">发票&nbsp&nbsp&nbsp号</label>
                            <input type="text" class="form-control" id="ticket_id" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="h_name">医院&nbsp&nbsp&nbsp名</label>
                            <input type="text" class="form-control" id="h_name" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="h_type">医院类型</label>
                            <input type="text" class="form-control" id="h_type" >
                        </div>
                    </div>

                    <div class="form-inline row">
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="u_name">姓&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp名</label>
                            <input type="text" class="form-control" id="u_name" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="u_sex">性&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp别</label>
                            <input type="text" class="form-control" id="u_sex" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="u_type">医保类型</label>
                            <input type="text" class="form-control" id="u_type" >
                        </div>
                    </div>

                    <div class="form-inline row">
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="count_lower">总&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp计</label>
                            <input type="text" class="form-control" id="count_lower" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="event_date">发票日期</label>
                            <input type="text" class="form-control" id="event_date" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="cash_pay">现金支付</label>
                            <input type="text" class="form-control" id="cash_pay" >
                        </div>
                    </div>

                    <div class="form-inline row">
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="person_pay">个人支付</label>
                            <input type="text" class="form-control" id="person_pay" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="plan_pay">医保统筹</label>
                            <input type="text" class="form-control" id="plan_pay" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="add_pay">附加支付</label>
                            <input type="text" class="form-control" id="add_pay" >
                        </div>
                    </div>

                    <div class="form-inline row">
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="cash_class">分类自负</label>
                            <input type="text" class="form-control" id="cash_class" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="cash_person">自&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp负</label>
                            <input type="text" class="form-control" id="cash_person" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="cash_myself">自&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp费</label>
                            <input type="text" class="form-control" id="cash_myself" >
                        </div>
                    </div>

                    <div class="form-inline row">
                        <div class="form-group col-lg-46 col-md-6">
                            <label for="cur_surplus">当年账户余额</label>
                            <input type="text" class="form-control" id="cur_surplus" >
                        </div>
                        <div class="form-group col-lg-46 col-md-6">
                            <label for="sum_surplus">历年账户余额</label>
                            <input type="text" class="form-control" id="sum_surplus" >
                        </div>
                    </div>

                    <div class="form-inline row">
                        <div class="form-group col-lg-46 col-md-6">
                            <label for="batch_id">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp批次号</label>
                            <input type="text" class="form-control" id="batch_id" >
                        </div>
                        <div class="form-group col-lg-46 col-md-6">
                            <label for="case_id">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp赔案号</label>
                            <input type="text" class="form-control" id="case_id" >
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button id="save_ticket" type="button" class="btn btn-primary">保存</button>
                </div>
            </div>
        </div>
    </div>
    <!--模态框结束-->
{% endblock %}

