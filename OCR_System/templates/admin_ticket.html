{% extends "admin_template.html" %}
{% block extend_js %}
    <script src="../static/js/admin_ticket.js"></script>
{% endblock %}
{% block extend_css %}
    <link rel="stylesheet" href="../static/css/admin_ticket.css">
{% endblock %}
{% block main %}
    <div class="col-lg-12 col-md-12">
        <div class="row">
            <div class="small_nav col-lg-7 col-md-7">
                <div id="ticket_count">共计 {{ ticket_count }} 张</div>
            </div>
            <div class="search_bar col-lg-5 col-md-5">
                <div class="input-group input-group-sm">
                    <input id="key_word" type="text" class="form-control">
                    <div class="input-group-btn">
                        <button id="current_class" data-name="ticket_id" type="button"
                                class="btn btn-default dropdown-toggle" data-toggle="dropdown"
                                aria-haspopup="true" aria-expanded="false">发票号 <span class="caret"></span></button>
                        <ul id="select_class" class="dropdown-menu dropdown-menu-right">
                            <li><a data-name="ticket_id" href="#">发票号</a></li>
                            <li><a data-name="h_name" href="#">医院名称</a></li>
                            <li><a data-name="u_name" href="#">姓名</a></li>
                        </ul>
                        <button id="launch_search" class="btn btn-primary btn-group-xs">Go</button>
                    </div><!-- /btn-group -->
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12 col-md-12">
            <table id="ticket_table" class="table table-hover">
                <tr>
                    <th>发票号</th>
                    <th>赔案号</th>
                    <th>批次号</th>
                    <th>归属</th>
                    <th>医院名称</th>
                    <th>姓名</th>
                    <th>金额</th>
                    <th>状态</th>
                    <th>日期</th>

                    <th>操作</th>
                </tr>
                {% for ticket in ticket_data %}
                    <tr id="{{ ticket.image_sn }}">
                        <td class="file_md5" style="display:none">{{ ticket.file_md5 }}</td>
                        <td class="file_name" style="display:none">{{ ticket.file_name }}</td>
                        <td class="ticket_id">{{ ticket.ticket_id }}</td>
                        <td class="case_name">{{ ticket.case_name }}</td>
                        <td class="batch_name">{{ ticket.batch_name }}</td>
                        <td class="company_alias">{{ ticket.company_alias }}</td>
                        <td class="h_name">{{ ticket.h_name }}</td>
                        <td class="h_type" style="display:none">{{ ticket.h_type }}</td>
                        <td class="u_name">{{ ticket.u_name }}</td>
                        <td class="u_sex" style="display:none">{{ ticket.u_sex }}</td>
                        <td class="u_type" style="display:none">{{ ticket.u_type }}</td>
                        <td class="count_lower">{{ ticket.count_lower }}</td>
                        <td class="description" onclick="javascript:alert('{{ ticket.description }}');">{{ "正常" if ticket.description == "" else "异常" }}</td>
                        <td class="begin_datetime">{{ ticket.begin_datetime }}</td>
                        <td class="cash_pay" style="display:none">{{ ticket.cash_pay }}</td>
                        <td class="person_pay" style="display:none">{{ ticket.person_pay }}</td>
                        <td class="plan_pay" style="display:none">{{ ticket.plan_pay }}</td>
                        <td class="add_pay" style="display:none">{{ ticket.add_pay }}</td>
                        <td class="cash_class" style="display:none">{{ ticket.cash_class }}</td>
                        <td class="cash_person" style="display:none">{{ ticket.cash_person }}</td>
                        <td class="cash_myself" style="display:none">{{ ticket.cash_myself }}</td>
                        <td class="cur_surplus" style="display:none">{{ ticket.cur_surplus }}</td>
                        <td class="sum_surplus" style="display:none">{{ ticket.sum_surplus }}</td>
                        <td class="batch_id" style="display:none">{{ ticket.batch_id }}</td>
                        <td class="case_id" style="display:none">{{ ticket.case_id }}</td>
                        <td class="not">
                            <div class="btn-group btn-group-xs" role="group">
                                <!--<div class="btn-group btn btn-default edit_btn" role="group"
                                     data-id="{{ ticket.file_md5 }}" onclick="edit_ticket($(this))">编辑
                                </div>-->
                                <a style="display: inline-block;font-size:12px;padding:2px 5px;" href="/manage_view_ticket?image_sn={{ ticket.image_sn }}&image_type={{ type_dict[ticket.ticket_type] }}" target="_blank">详细</a>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            </table>
        </div>
    </div>
    <!-- 底部分页 -->
    <div class="row text-center">
        <nav aria-label>
            <ul id="page_list" class="pagination">
                <li class="{{ 'disabled' if index_range[0] == 1 else '' }}"><a
                        href="/manage_tickets?index={{ prev_index }}" aria-label="Previous"><span
                        aria-hidden="true">&laquo;</span></a></li>
                {% for index in index_range %}
                    <li class="{{ 'active' if index == current_index else '' }}">
                        <a href="/manage_tickets?index={{ index }}">{{ index }}</a>
                    </li>
                {% endfor %}
                <li class="{{ 'disabled' if index_range[-1] == max_index else '' }}"><a
                        href="/manage_tickets?index={{ next_index }}" aria-label="Next"><span
                        aria-hidden="true">»</span></a></li>
            </ul>
        </nav>
    </div>
    </div>
    <!--模态框-->
    <button id="pop_modal" style="display: none" type="button" class="btn btn-primary btn-lg" data-toggle="modal"
            data-target="#myModal">
        Launch demo modal
    </button>

    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" style="text-align: center" id="myModalLabel">编辑发票信息</h4>
                </div>
                <div class="modal-body">

                    <div class="form-inline row">
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="ticket_id">发票&nbsp&nbsp&nbsp号</label>
                            <input type="text" class="form-control" id="ticket_id" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="h_name">医院&nbsp&nbsp&nbsp名</label>
                            <input type="text" class="form-control" id="h_name" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="h_type">医院类型</label>
                            <input type="text" class="form-control" id="h_type" >
                        </div>
                    </div>

                    <div class="form-inline row">
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="u_name">姓&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp名</label>
                            <input type="text" class="form-control" id="u_name" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="u_sex">性&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp别</label>
                            <input type="text" class="form-control" id="u_sex" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="u_type">医保类型</label>
                            <input type="text" class="form-control" id="u_type" >
                        </div>
                    </div>

                    <div class="form-inline row">
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="count_lower">总&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp计</label>
                            <input type="text" class="form-control" id="count_lower" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="event_date">发票日期</label>
                            <input type="text" class="form-control" id="event_date" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="cash_pay">现金支付</label>
                            <input type="text" class="form-control" id="cash_pay" >
                        </div>
                    </div>

                    <div class="form-inline row">
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="person_pay">个人支付</label>
                            <input type="text" class="form-control" id="person_pay" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="plan_pay">医保统筹</label>
                            <input type="text" class="form-control" id="plan_pay" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="add_pay">附加支付</label>
                            <input type="text" class="form-control" id="add_pay" >
                        </div>
                    </div>

                    <div class="form-inline row">
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="cash_class">分类自负</label>
                            <input type="text" class="form-control" id="cash_class" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="cash_person">自&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp负</label>
                            <input type="text" class="form-control" id="cash_person" >
                        </div>
                        <div class="form-group col-lg-4 col-md-4">
                            <label for="cash_myself">自&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp费</label>
                            <input type="text" class="form-control" id="cash_myself" >
                        </div>
                    </div>

                    <div class="form-inline row">
                        <div class="form-group col-lg-46 col-md-6">
                            <label for="cur_surplus">当年账户余额</label>
                            <input type="text" class="form-control" id="cur_surplus" >
                        </div>
                        <div class="form-group col-lg-46 col-md-6">
                            <label for="sum_surplus">历年账户余额</label>
                            <input type="text" class="form-control" id="sum_surplus" >
                        </div>
                    </div>

                    <div class="form-inline row">
                        <div class="form-group col-lg-46 col-md-6">
                            <label for="batch_id">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp批次号</label>
                            <input type="text" class="form-control" id="batch_id" >
                        </div>
                        <div class="form-group col-lg-46 col-md-6">
                            <label for="case_id">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp赔案号</label>
                            <input type="text" class="form-control" id="case_id" >
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button id="save_ticket" type="button" class="btn btn-primary">保存</button>
                </div>
            </div>
        </div>
    </div>
    <!--模态框结束-->
{% endblock %}

